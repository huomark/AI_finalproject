#include <bits/stdc++.h>
 using i64 = long long;
 int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
        int n, m, k;
    std::cin >> n >> m >> k;
        std::vector<int> c(n);
    for (int i = 0; i < n; i++) {
        std::cin >> c[i];
    }
        constexpr int inf = 1E9;
    std::vector d(2 * n, std::vector<int>(2 * n, inf));
    for (int i = 0; i < 2 * n; i++) {
        d[i][i] = 0;
    }
    for (int i = 0; i < m; i++) {
        int u, v;
        std::cin >> u >> v;
        u--, v--;
        int x = (c[u] != c[v]);
        d[2 * u][2 * v + x] = 1;
        d[2 * u + 1][2 * v + !x] = 1;
        d[2 * v][2 * u + x] = 1;
        d[2 * v + 1][2 * u + !x] = 1;
    }
        for (int k = 0; k < 2 * n; k++) {
        for (int i = 0; i < 2 * n; i++) {
            for (int j = 0; j < 2 * n; j++) {
                d[i][j] = std::min(d[i][j], d[i][k] + d[k][j]);
            }
        }
    }
        int ans = 0;
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            int d0 = d[2 * i][2 * j];
            int d1 = d[2 * i][2 * j + 1];
                        ans = std::max(ans, std::min({d0 + k, d1 + k, (d0 + d1 + k) / 2}));
        }
    }
        std::cout << ans << "\n";
    return 0;
}